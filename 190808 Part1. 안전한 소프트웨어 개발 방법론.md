



## Part1. 안전한 소프트웨어 개발 방법론

### ch1 시큐어코딩의 개요



#### 소프트웨어 개발보안의 필요성

웹을 통해 서비스를 하는 요즘 어떤 방법으로 공격이 들어오는지 분석해보았다

1차: 웹서터 해킹, 인터넷을 통하 내부 사용자 pc해킹



- 침해사고 사례

##### 인증 여부 체크 

타입2 지식(내가 알고 있는 것-비밀번호)

타입1 소유(내가 가지고 있는 것-보안카드, 열쇠)

타입1 특징(나만 가지고 있는 것-지문,홍체,서명,정맥)



인증 2개 사용:  2 factor

인증 3개 사용:  multi factor



#### 개발보안을 통해 할 수 있는 것

- 인증과 인가

- 입력값 검증 강화



ISMS-P 운영시스템에 대해서 보안성의 체계가 잘 되어 보안이 잘 갖춰진것지 판단하는 제도



##### 파일 업로드 취약점

파일 업로드 기능을 제고하는 사이트에서

업로드 파일의 크기와 개수를 제한하지 않거나

(서버의 연결 및 디스크 자원을 고갈시켜 정상적깅 서비스를 방해(Dos)하고 연결 자원 고갈시킴-파일이 너무 크면 다른 부분에서 사용하지 못함)

업로드 파일의 종류를 제한하지 않거나(서버에서 실행 가능한 웹쉘 파일을 실행해서 서버의 제어권을 탈취한다-원격제어로 마음대로 조절한다

악성코드가 포함된 실행파일을 업로드 한 후 불특정 다수가 다운로드 하도록 유도 - 악성고트 유포지로 악용된다),

외부에서 접근 가능한 경로에서 파일을 저장하는 경우에 발생하는 취약점



##### 파일 업로드 기법 방어 기법

원인1 업로드 파일의 크기, 개수,종류를 제한하지 않는다

방법 --> 1. 업로드 파일의 크기와 개수를 제한

2. 업로드 파일의 종류 제한

3. 외부에서 접근할 수 없는 경로에 업로드 파일을 저장

4. 업로드 파일의 저장 경로와 파일명을 외부에서 알 수 없도록 한다
5. 업로드 파일의 실행 속성을 제거한 후 저장한다





#### 보안취약점 정보 활용

##### CWE(Common Weakness Enumeration)

보안 약점에 관한 내용 모아놓은 것/ 보안 취약점 모아놓은 db

##### CVE(Common Vulnerabilities and Exposures)

시간에 따라 감지된 보안 취약점 또는 위험 노퉆을 정리해준 목록

##### CWSS(Common Weakness Scoring System)

취약점의 위험성을 정량화하기 위한 점수 체계 --> 정량화를 통해 위험한 우선순위를  정하기 위해서(먼저 대응할 것들 정하려고) 

##### SANS TOP25 Most Dangerous Software Errors

Sans라는 기관에서 CWE,CVE에 있는 것들 중 가장 위험한 25개 소프트웨어 에러 모아놓은 것

- 구성요소간 안전하지 않은 상호작용 6개
- 위험한 자원관리 8개
- 허점이 많은 방어 11개







#### SANS TOP25 Most Dangerous Software Errors

#### 1. 구성요소간 안전하지 않은 상호작용 6개

- 피해: db 조작, 제어권 탈취 후 마음대로 제어

  

##### 1위 CWE-89  sql 명령에 사용된 특별한 엘리먼트를 무효화하지 않는 것

sql 예약어(for, where, select...) 또는 특수 기호(=, <, >...) ==> 메타 문자(어떤 기능에서 의미를 가지고 있는 문자)

무효화: esc / = 메타문자에서 의미를 제거하고 문자만 남기는 것

sql injection:  외부 입력값을 쿼리 조작 문자열 포함 여부를 확인하지 않고

쿼리 생성 및 실행에  사용하는 경우 발생 --> 원리 의미와 다른 형태로 쿼리가 변형되어서 실행되는 것



##### 2위 운영체게 명령어 삽입(command injection)

- 운영체게 명령어 실행 부분이 존재하는 경우, 외부 입력값을 검증, 제한하지 않고 명령어 또는 명령어릐 일부로 사용하는 경우 발생



예시) String cmd  = request.getParmameter("cmd");

Runtime,getRuntime().exec (cmd);



// 외부 입력값을 검증, 제한하지 않고 명령어로 사용하는 경유 --> 의도하지 않은 명령어가 실행된다

String cmd = reqeust.getParmameter("file");

Runtime.getRuntime().exec("type C://data" + file)



##### 4위 크로스 사이트 스크립팅(XSS)

- 웹 페이지 생성에 사용된 입력값 검증이 이뤄지지 않은 것

if 동적페이지 만들 때

입력값 검증의 뜻: 입력값이 페이지 생성에 사용되었음을 나타냄 or 실행가능한 코드가 입력값에 포함되어 있다

- 공격자가 전달 한 스크립트 코드가 사용자(희생자) 브라우저를 통해 실행되는 것

  - 저장 xss (Stored)

  - ###### 반사 xss (Reflection)



#### 2. 위험한 자원관리 8개

사이트간 요청 위조 = 크로스 요청 위조 =CSRF(Cross- Site Request Forgery)

: 요청을 받은 서버 프로그램이, 요청을 받은 서버측 프로그램이 요청 주최와 요청 절차를 검증하지 않고 요청을 처리했을 때 발생

[입력화면]                                                                                  [처리]

패스워드 변경 요청                                                          패스워드 변경 처리

changePasswordForm.jsp  ---------- 호출 --------->      ChangePasswordProc.jsp

​																						1) 인증 여부 확인

​																						2) 변경에 필요한 정보가 전달 되었는지

​																						3) 세션으로부터 변경 대상 정보를 추출

​																						4) loginUser.px  --> new update



CORS: SOP 정책 완화시켜주는 정책

다른 사이트의 자원을 교차해서 사용할 수 있도록 해주는 정책

CSP: 개발자가 만들었는지 외부에서 입력된건지 알 수 있게 해주는 정책